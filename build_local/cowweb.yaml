apiVersion: v1
kind: Namespace
metadata:
  name: cowweb-local-dev
---
apiVersion: v1
kind: Service
metadata:
  name: cowweb
  namespace: cowweb-local-dev
spec:
  type: NodePort
  selector:
    app: cowweb
    profile: local-dev
  ports:
  - name: api
    port: 8080
    nodePort: 30080
  - name: debug
    port: 8081
    nodePort: 30081
---
apiVersion: v1
kind: Pod
metadata:
  name: cowweb
  namespace: cowweb-local-dev
  labels:
    app: cowweb
    profile: local-dev
spec:
  containers:
  - name: cowweb
    image: docker.io/hhayakaw/cowweb
    ports:
    - name: api
      containerPort: 8080
    readinessProbe:
      httpGet:
        path: /cowsay/ping
        port: api
      initialDelaySeconds: 5
      periodSeconds: 10
    livenessProbe:
      httpGet:
        path: /cowsay/ping
        port: api
      initialDelaySeconds: 15
      periodSeconds: 20
